{% extends 'base.html' %}

{% block metas %}
{{super()}}
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
{% endblock %}

{% block app_content %}
<h1>Hi, {{ current_user.full_name }}!</h1>

<table>
    <tr>
        <td>Online since:</td>
        <td id="param_online"></td>
    </tr>
    <tr>
        <td>Temp Onboard:</td>
        <td id="param_t0"></td>
    </tr>
    <tr>
        <td>Temp Baro:</td>
        <td id="param_tb"></td>
    </tr>
    <tr>
        <td>Baro:</td>
        <td id="param_baro"></td>
    </tr>

</table>

{% endblock %}

{% block scripts %}
{{super()}}
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.8.0/dist/Chart.min.js"></script>
<script>
    function get_data(){ 
        $.getJSON("/data/current", function (data, status){
            document.getElementById("param_online").innerHTML = data.status.StartTime;
            document.getElementById("param_t0").innerHTML = data.raw.temperature[0].temperature;
            document.getElementById("param_tb").innerHTML = data.baro.temp;
            document.getElementById("param_baro").innerHTML = data.baro.pressure;
        });
    }
    get_data();
    setInterval(get_data, 10000);
</script>
{% endblock %}